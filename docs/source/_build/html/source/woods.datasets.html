<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>woods.datasets module &mdash; WOODS  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> WOODS
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Quick Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installing-requirements">Installing requirements</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#with-conda">With Conda</a></li>
<li class="toctree-l3"><a class="reference internal" href="../installation.html#with-venv">With venv</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#clone-locally">Clone locally</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#run-tests">Run tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../running_a_sweep.html">Running a  Sweep</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../running_a_sweep.html#downloading-the-data">Downloading the data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../running_a_sweep.html#direct-preprocessed-download">Direct Preprocessed Download</a></li>
<li class="toctree-l3"><a class="reference internal" href="../running_a_sweep.html#source-download-and-preprocess">Source Download and Preprocess</a></li>
<li class="toctree-l3"><a class="reference internal" href="../running_a_sweep.html#datasets-info">Datasets Info</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../running_a_sweep.html#running-the-sweep">Running the sweep</a></li>
<li class="toctree-l2"><a class="reference internal" href="../running_a_sweep.html#compiling-the-results">Compiling the results</a></li>
<li class="toctree-l2"><a class="reference internal" href="../running_a_sweep.html#advanced-usage">Advanced usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../adding_an_algorithm.html">Adding an Algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../adding_an_algorithm.html#defining-the-algorithm">Defining the Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adding_an_algorithm.html#adding-necessary-pieces">Adding necessary pieces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adding_an_algorithm.html#run-some-tests">Run some tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adding_an_algorithm.html#try-the-algorithm">Try the algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adding_an_algorithm.html#run-a-sweep">Run a sweep</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../adding_a_dataset.html">Adding a Dataset</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../adding_a_dataset.html#defining-the-algorithm">Defining the Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adding_a_dataset.html#adding-necessary-pieces">Adding necessary pieces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adding_a_dataset.html#run-some-tests">Run some tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adding_a_dataset.html#try-the-algorithm">Try the algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../adding_a_dataset.html#run-a-sweep">Run a sweep</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../woods.html">WOODS</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../woods.command_launchers.html">woods.command_launchers module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../woods.command_launchers.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../woods.command_launchers.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../woods.datasets.html">woods.datasets module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../woods.datasets.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../woods.datasets.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../woods.hyperparams.html">woods.hyperparams module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../woods.hyperparams.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../woods.hyperparams.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../woods.model_selection.html">woods.model_selection module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../woods.model_selection.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../woods.model_selection.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../woods.models.html">woods.models module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../woods.models.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../woods.models.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../woods.objectives.html">woods.objectives module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../woods.objectives.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../woods.objectives.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../woods.train.html">woods.train module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../woods.train.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../woods.train.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../woods.train_step.html">woods.train_step module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../woods.utils.html">woods.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../woods.utils.html#summary">Summary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../woods.utils.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../woods.scripts.html">woods.scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../woods.scripts.compile_results.html">woods.scripts.compile_results module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../woods.scripts.download.html">woods.scripts.download module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../woods.scripts.fetch_and_preprocess.html">woods.scripts.fetch_and_preprocess module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../woods.scripts.fetch_and_preprocess.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../woods.scripts.fetch_and_preprocess.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../woods.scripts.hparams_sweep.html">woods.scripts.hparams_sweep module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../woods.scripts.hparams_sweep.html#summary">Summary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../woods.scripts.hparams_sweep.html#reference">Reference</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../woods.scripts.main.html">woods.scripts.main module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../woods.scripts.visualize_results.html">woods.scripts.visualize_results module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WOODS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>woods.datasets module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/woods.datasets.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-woods.datasets">
<span id="woods-datasets-module"></span><h1>woods.datasets module<a class="headerlink" href="#module-woods.datasets" title="Permalink to this headline"></a></h1>
<p>Defining the benchmarks for OoD generalization in time-series</p>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline"></a></h2>
<p>Classes:</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.Basic_Fourier" title="woods.datasets.Basic_Fourier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Basic_Fourier</span></code></a></p></td>
<td><p>Fourier_basic dataset</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#woods.datasets.CAP" title="woods.datasets.CAP"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CAP</span></code></a></p></td>
<td><p>CAP Sleep stage dataset</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.EEG_dataset" title="woods.datasets.EEG_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">EEG_dataset</span></code></a></p></td>
<td><p>HDF5 dataset for EEG data</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.HAR" title="woods.datasets.HAR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HAR</span></code></a></p></td>
<td><p>Heterogeneity Acrivity Recognition Dataset (HAR)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.InfiniteLoader" title="woods.datasets.InfiniteLoader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InfiniteLoader</span></code></a></p></td>
<td><p>InfiniteLoader is a torch.utils.data.IterableDataset that can be used to infinitely iterate over a finite dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.InfiniteSampler" title="woods.datasets.InfiniteSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InfiniteSampler</span></code></a></p></td>
<td><p>Infinite Sampler for PyTorch.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.LSA64" title="woods.datasets.LSA64"><code class="xref py py-obj docutils literal notranslate"><span class="pre">LSA64</span></code></a></p></td>
<td><p>LSA64: A Dataset for Argentinian Sign Language dataset</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.MI" title="woods.datasets.MI"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MI</span></code></a></p></td>
<td><p>MI datasets</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.Multi_Domain_Dataset" title="woods.datasets.Multi_Domain_Dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Multi_Domain_Dataset</span></code></a></p></td>
<td><p>Abstract class of a multi domain dataset for OOD generalization.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#woods.datasets.SEDFx" title="woods.datasets.SEDFx"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SEDFx</span></code></a></p></td>
<td><p>SEDFx Sleep stage dataset</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.Sleep_DB" title="woods.datasets.Sleep_DB"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Sleep_DB</span></code></a></p></td>
<td><p>Class for Sleep Staging datasets with their data stored in a HDF5 file</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.Spurious_Fourier" title="woods.datasets.Spurious_Fourier"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Spurious_Fourier</span></code></a></p></td>
<td><p>Spurious_Fourier dataset</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.StockVolatility" title="woods.datasets.StockVolatility"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StockVolatility</span></code></a></p></td>
<td><p>Stock Volatility Dataset</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.TCMNIST" title="woods.datasets.TCMNIST"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TCMNIST</span></code></a></p></td>
<td><p>Abstract class for Temporal Colored MNIST</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.TCMNIST_seq" title="woods.datasets.TCMNIST_seq"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TCMNIST_seq</span></code></a></p></td>
<td><p>Temporal Colored MNIST Sequence</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.TCMNIST_step" title="woods.datasets.TCMNIST_step"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TCMNIST_step</span></code></a></p></td>
<td><p>Temporal Colored MNIST Step</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.TMNIST" title="woods.datasets.TMNIST"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TMNIST</span></code></a></p></td>
<td><p>Temporal MNIST dataset</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.Video_dataset" title="woods.datasets.Video_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Video_dataset</span></code></a></p></td>
<td><p>Video dataset</p></td>
</tr>
</tbody>
</table>
<p>Functions:</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.XOR" title="woods.datasets.XOR"><code class="xref py py-obj docutils literal notranslate"><span class="pre">XOR</span></code></a></p></td>
<td><p>Returns a XOR b (the 'Exclusive or' gate)</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.bernoulli" title="woods.datasets.bernoulli"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bernoulli</span></code></a></p></td>
<td><p>Returns a tensor of 1.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.get_dataset_class" title="woods.datasets.get_dataset_class"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_dataset_class</span></code></a></p></td>
<td><p>Return the dataset class with the given name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.get_environments" title="woods.datasets.get_environments"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_environments</span></code></a></p></td>
<td><p>Returns the environments of a dataset</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.get_setup" title="woods.datasets.get_setup"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_setup</span></code></a></p></td>
<td><p>Returns the setup of a dataset</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.get_split" title="woods.datasets.get_split"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_split</span></code></a></p></td>
<td><p>Generates the keys that are used to split a Torch TensorDataset into (1-holdout_fraction) / holdout_fraction.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.make_split" title="woods.datasets.make_split"><code class="xref py py-obj docutils literal notranslate"><span class="pre">make_split</span></code></a></p></td>
<td><p>Split a Torch TensorDataset into (1-holdout_fraction) / holdout_fraction.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../woods.datasets.html#woods.datasets.num_environments" title="woods.datasets.num_environments"><code class="xref py py-obj docutils literal notranslate"><span class="pre">num_environments</span></code></a></p></td>
<td><p>Returns the number of environments of a dataset</p></td>
</tr>
</tbody>
</table>
</section>
<section id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="woods.datasets.get_dataset_class">
<span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">get_dataset_class</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.get_dataset_class" title="Permalink to this definition"></a></dt>
<dd><p>Return the dataset class with the given name.</p>
<p>Taken from : <a class="reference external" href="https://github.com/facebookresearch/DomainBed/">https://github.com/facebookresearch/DomainBed/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset_name</strong> (<em>str</em>) – Name of the dataset to get the function of. (Must be a part of the DATASETS list)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The __init__ function of the desired dataset that takes as input (  flags: parser arguments of the train.py script, training_hparams: set of training hparams from hparams.py )</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>function</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Dataset name not found in the datasets.py globals</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="woods.datasets.num_environments">
<span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">num_environments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.num_environments" title="Permalink to this definition"></a></dt>
<dd><p>Returns the number of environments of a dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset_name</strong> (<em>str</em>) – Name of the dataset to get the number of environments of. (Must be a part of the DATASETS list)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of environments of the dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="woods.datasets.get_environments">
<span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">get_environments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.get_environments" title="Permalink to this definition"></a></dt>
<dd><p>Returns the environments of a dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset_name</strong> (<em>str</em>) – Name of the dataset to get the number of environments of. (Must be a part of the DATASETS list)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of environments of the dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="woods.datasets.get_setup">
<span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">get_setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.get_setup" title="Permalink to this definition"></a></dt>
<dd><p>Returns the setup of a dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset_name</strong> (<em>str</em>) – Name of the dataset to get the number of environments of. (Must be a part of the DATASETS list)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The setup of the dataset (‘seq’ or ‘step’)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="woods.datasets.XOR">
<span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">XOR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">a</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.XOR" title="Permalink to this definition"></a></dt>
<dd><p>Returns a XOR b (the ‘Exclusive or’ gate)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> (<em>bool</em>) – First input</p></li>
<li><p><strong>b</strong> (<em>bool</em>) – Second input</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output of the XOR gate</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="woods.datasets.bernoulli">
<span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">bernoulli</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.bernoulli" title="Permalink to this definition"></a></dt>
<dd><p>Returns a tensor of 1. (True) or 0. (False) resulting from the outcome of a bernoulli random variable of parameter p.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> (<em>float</em>) – Parameter p of the Bernoulli distribution</p></li>
<li><p><strong>size</strong> (<em>int</em><em>...</em>) – A sequence of integers defining hte shape of the output tensor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor of Bernoulli random variables of parameter p</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="woods.datasets.make_split">
<span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">make_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">holdout_fraction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.make_split" title="Permalink to this definition"></a></dt>
<dd><p>Split a Torch TensorDataset into (1-holdout_fraction) / holdout_fraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>TensorDataset</em>) – Tensor dataset that has 2 tensors -&gt; data, targets</p></li>
<li><p><strong>holdout_fraction</strong> (<em>float</em>) – Fraction of the dataset that is gonna be in the validation set</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – seed used for the shuffling of the data before splitting. Defaults to 0.</p></li>
<li><p><strong>sort</strong> (<em>bool</em><em>, </em><em>optional</em>) – If ‘’True’’ the dataset is gonna be sorted after splitting. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>1-holdout_fraction part of the split
TensorDataset: holdout_fractoin part of the split</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>TensorDataset</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="woods.datasets.get_split">
<span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">get_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">holdout_fraction</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.get_split" title="Permalink to this definition"></a></dt>
<dd><p>Generates the keys that are used to split a Torch TensorDataset into (1-holdout_fraction) / holdout_fraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>TensorDataset</em>) – TensorDataset to be split</p></li>
<li><p><strong>holdout_fraction</strong> (<em>float</em>) – Fraction of the dataset that is gonna be in the out (validation) set</p></li>
<li><p><strong>seed</strong> (<em>int</em><em>, </em><em>optional</em>) – seed used for the shuffling of the data before splitting. Defaults to 0.</p></li>
<li><p><strong>sort</strong> (<em>bool</em><em>, </em><em>optional</em>) – If ‘’True’’ the dataset is gonna be sorted after splitting. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>in (1-holdout_fraction) keys of the split
list: out (holdout_fraction) keys of the split</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.InfiniteSampler">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">InfiniteSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sampler</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.InfiniteSampler" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.sampler.T_co</span></code>]</p>
<p>Infinite Sampler for PyTorch.</p>
<p>Inspired from : <a class="reference external" href="https://github.com/facebookresearch/DomainBed">https://github.com/facebookresearch/DomainBed</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sampler</strong> (<em>torch.utils.data.Sampler</em>) – Sampler to be used for the infinite sampling.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.InfiniteLoader">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">InfiniteLoader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.InfiniteLoader" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.dataset.Dataset</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.dataset.T_co</span></code>]</p>
<p>InfiniteLoader is a torch.utils.data.IterableDataset that can be used to infinitely iterate over a finite dataset.</p>
<p>Inspired from : <a class="reference external" href="https://github.com/facebookresearch/DomainBed">https://github.com/facebookresearch/DomainBed</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – Dataset to be iterated over</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size of the dataset</p></li>
<li><p><strong>num_workers</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of workers to use for the data loading. Defaults to 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">Multi_Domain_Dataset</span></span><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Abstract class of a multi domain dataset for OOD generalization.</p>
<p>Every multi domain dataset must redefine the important attributes: SETUP, PRED_TIME, ENVS, INPUT_SHAPE, OUTPUT_SIZE
The data dimension needs to be (batch_size, SEQ_LEN, <a href="#id1"><span class="problematic" id="id2">*</span></a>INPUT_SHAPE)</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.N_STEPS">
<span class="sig-name descname"><span class="pre">N_STEPS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">5001</span></em><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.N_STEPS" title="Permalink to this definition"></a></dt>
<dd><p>The number of training steps taken for this dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.CHECKPOINT_FREQ">
<span class="sig-name descname"><span class="pre">CHECKPOINT_FREQ</span></span><em class="property"> <span class="pre">=</span> <span class="pre">100</span></em><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.CHECKPOINT_FREQ" title="Permalink to this definition"></a></dt>
<dd><p>The frequency of results update</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.N_WORKERS">
<span class="sig-name descname"><span class="pre">N_WORKERS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">4</span></em><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.N_WORKERS" title="Permalink to this definition"></a></dt>
<dd><p>The number of workers used for fast dataloaders used for validation</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.SETUP">
<span class="sig-name descname"><span class="pre">SETUP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.SETUP" title="Permalink to this definition"></a></dt>
<dd><p>The setup of the dataset (‘seq’ or ‘step’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.SEQ_LEN">
<span class="sig-name descname"><span class="pre">SEQ_LEN</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.SEQ_LEN" title="Permalink to this definition"></a></dt>
<dd><p>The sequence length of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.PRED_TIME">
<span class="sig-name descname"><span class="pre">PRED_TIME</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[None]</span></em><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.PRED_TIME" title="Permalink to this definition"></a></dt>
<dd><p>The time steps where predictions are made</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.ENVS">
<span class="sig-name descname"><span class="pre">ENVS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[None]</span></em><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.ENVS" title="Permalink to this definition"></a></dt>
<dd><p>The environments of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.INPUT_SHAPE">
<span class="sig-name descname"><span class="pre">INPUT_SHAPE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.INPUT_SHAPE" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the input (excluding batch size and time dimension)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.OUTPUT_SIZE">
<span class="sig-name descname"><span class="pre">OUTPUT_SIZE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.OUTPUT_SIZE" title="Permalink to this definition"></a></dt>
<dd><p>The size of the output</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.get_class_weight">
<span class="sig-name descname"><span class="pre">get_class_weight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.get_class_weight" title="Permalink to this definition"></a></dt>
<dd><p>Compute class weight for class balanced training</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of weights of length OUTPUT_SIZE</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.get_train_loaders">
<span class="sig-name descname"><span class="pre">get_train_loaders</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.get_train_loaders" title="Permalink to this definition"></a></dt>
<dd><p>Fetch all training dataloaders and their ID</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of string names of the data splits used for training
list: list of dataloaders of the data splits used for training</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.get_val_loaders">
<span class="sig-name descname"><span class="pre">get_val_loaders</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.get_val_loaders" title="Permalink to this definition"></a></dt>
<dd><p>Fetch all validation/test dataloaders and their ID</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of string names of the data splits used for validation and test
list: list of dataloaders of the data splits used for validation and test</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.Multi_Domain_Dataset.split_data">
<span class="sig-name descname"><span class="pre">split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.Multi_Domain_Dataset.split_data" title="Permalink to this definition"></a></dt>
<dd><p>Group data and prediction by environment</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>Tensor</em>) – output from a model of shape ((n_env-1)*batch_size, len(PRED_TIME), output_size)</p></li>
<li><p><strong>labels</strong> (<em>Tensor</em>) – labels of shape ((n_env-1)*batch_size, len(PRED_TIME), output_size)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The reshaped output (n_train_env, batch_size, len(PRED_TIME), output_size)
Tensor: The labels (n_train_env, batch_size, len(PRED_TIME))</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.Basic_Fourier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">Basic_Fourier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_hparams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.Basic_Fourier" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.Multi_Domain_Dataset" title="woods.datasets.Multi_Domain_Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.Multi_Domain_Dataset</span></code></a></p>
<p>Fourier_basic dataset</p>
<p>A dataset of 1D sinusoid signal to classify according to their Fourier spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>argparse.Namespace</em>) – argparse of training arguments</p></li>
<li><p><strong>training_hparams</strong> (<em>dict</em>) – dictionnary of training hyper parameters coming from the hyperparams.py file</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No download is required as it is purely synthetic</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Basic_Fourier.SETUP">
<span class="sig-name descname"><span class="pre">SETUP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'seq'</span></em><a class="headerlink" href="#woods.datasets.Basic_Fourier.SETUP" title="Permalink to this definition"></a></dt>
<dd><p>The setup of the dataset (‘seq’ or ‘step’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Basic_Fourier.SEQ_LEN">
<span class="sig-name descname"><span class="pre">SEQ_LEN</span></span><em class="property"> <span class="pre">=</span> <span class="pre">50</span></em><a class="headerlink" href="#woods.datasets.Basic_Fourier.SEQ_LEN" title="Permalink to this definition"></a></dt>
<dd><p>The sequence length of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Basic_Fourier.PRED_TIME">
<span class="sig-name descname"><span class="pre">PRED_TIME</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[49]</span></em><a class="headerlink" href="#woods.datasets.Basic_Fourier.PRED_TIME" title="Permalink to this definition"></a></dt>
<dd><p>The time steps where predictions are made</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Basic_Fourier.ENVS">
<span class="sig-name descname"><span class="pre">ENVS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">['no_spur']</span></em><a class="headerlink" href="#woods.datasets.Basic_Fourier.ENVS" title="Permalink to this definition"></a></dt>
<dd><p>The environments of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Basic_Fourier.INPUT_SHAPE">
<span class="sig-name descname"><span class="pre">INPUT_SHAPE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[1]</span></em><a class="headerlink" href="#woods.datasets.Basic_Fourier.INPUT_SHAPE" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the input (excluding batch size and time dimension)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Basic_Fourier.OUTPUT_SIZE">
<span class="sig-name descname"><span class="pre">OUTPUT_SIZE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">2</span></em><a class="headerlink" href="#woods.datasets.Basic_Fourier.OUTPUT_SIZE" title="Permalink to this definition"></a></dt>
<dd><p>The size of the output</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.Spurious_Fourier">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">Spurious_Fourier</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_hparams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.Spurious_Fourier" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.Multi_Domain_Dataset" title="woods.datasets.Multi_Domain_Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.Multi_Domain_Dataset</span></code></a></p>
<p>Spurious_Fourier dataset</p>
<p>A dataset of 1D sinusoid signal to classify according to their Fourier spectrum.
Peaks in the fourier spectrum are added to the signal that are spuriously correlated to the label.
Different environment have different correlation rates between the labels and the spurious peaks in the spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>argparse.Namespace</em>) – argparse of training arguments</p></li>
<li><p><strong>training_hparams</strong> (<em>dict</em>) – dictionnary of training hyper parameters coming from the hyperparams.py file</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>No download is required as it is purely synthetic</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Spurious_Fourier.SETUP">
<span class="sig-name descname"><span class="pre">SETUP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'seq'</span></em><a class="headerlink" href="#woods.datasets.Spurious_Fourier.SETUP" title="Permalink to this definition"></a></dt>
<dd><p>The setup of the dataset (‘seq’ or ‘step’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Spurious_Fourier.INPUT_SHAPE">
<span class="sig-name descname"><span class="pre">INPUT_SHAPE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[1]</span></em><a class="headerlink" href="#woods.datasets.Spurious_Fourier.INPUT_SHAPE" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the input (excluding batch size and time dimension)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Spurious_Fourier.OUTPUT_SIZE">
<span class="sig-name descname"><span class="pre">OUTPUT_SIZE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">2</span></em><a class="headerlink" href="#woods.datasets.Spurious_Fourier.OUTPUT_SIZE" title="Permalink to this definition"></a></dt>
<dd><p>The size of the output</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Spurious_Fourier.SEQ_LEN">
<span class="sig-name descname"><span class="pre">SEQ_LEN</span></span><em class="property"> <span class="pre">=</span> <span class="pre">50</span></em><a class="headerlink" href="#woods.datasets.Spurious_Fourier.SEQ_LEN" title="Permalink to this definition"></a></dt>
<dd><p>The sequence length of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Spurious_Fourier.PRED_TIME">
<span class="sig-name descname"><span class="pre">PRED_TIME</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[49]</span></em><a class="headerlink" href="#woods.datasets.Spurious_Fourier.PRED_TIME" title="Permalink to this definition"></a></dt>
<dd><p>The time steps where predictions are made</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Spurious_Fourier.LABEL_NOISE">
<span class="sig-name descname"><span class="pre">LABEL_NOISE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0.25</span></em><a class="headerlink" href="#woods.datasets.Spurious_Fourier.LABEL_NOISE" title="Permalink to this definition"></a></dt>
<dd><p>Level of noise added to the labels</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Spurious_Fourier.ENVS">
<span class="sig-name descname"><span class="pre">ENVS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[0.1,</span> <span class="pre">0.8,</span> <span class="pre">0.9]</span></em><a class="headerlink" href="#woods.datasets.Spurious_Fourier.ENVS" title="Permalink to this definition"></a></dt>
<dd><p>The correlation rate between the label and the spurious peaks</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.Spurious_Fourier.super_sample">
<span class="sig-name descname"><span class="pre">super_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">signal_0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">signal_1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.Spurious_Fourier.super_sample" title="Permalink to this definition"></a></dt>
<dd><p>Sample signals frames with a bunch of offsets</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.TMNIST">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">TMNIST</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_hparams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.TMNIST" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.Multi_Domain_Dataset" title="woods.datasets.Multi_Domain_Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.Multi_Domain_Dataset</span></code></a></p>
<p>Temporal MNIST dataset</p>
<p>Each sample is a sequence of 4 MNIST digits.
The task is to predict at each step if the sum of the current digit and the previous one is odd or even.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>argparse.Namespace</em>) – argparse of training arguments</p></li>
<li><p><strong>training_hparams</strong> (<em>dict</em>) – dictionnary of training hyper parameters coming from the hyperparams.py file</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The MNIST dataset needs to be downloaded, this is automaticaly done if the dataset isn’t in the given data_path</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TMNIST.N_STEPS">
<span class="sig-name descname"><span class="pre">N_STEPS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">5001</span></em><a class="headerlink" href="#woods.datasets.TMNIST.N_STEPS" title="Permalink to this definition"></a></dt>
<dd><p>The number of training steps taken for this dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TMNIST.SETUP">
<span class="sig-name descname"><span class="pre">SETUP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'seq'</span></em><a class="headerlink" href="#woods.datasets.TMNIST.SETUP" title="Permalink to this definition"></a></dt>
<dd><p>The setup of the dataset (‘seq’ or ‘step’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TMNIST.SEQ_LEN">
<span class="sig-name descname"><span class="pre">SEQ_LEN</span></span><em class="property"> <span class="pre">=</span> <span class="pre">4</span></em><a class="headerlink" href="#woods.datasets.TMNIST.SEQ_LEN" title="Permalink to this definition"></a></dt>
<dd><p>The sequence length of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TMNIST.PRED_TIME">
<span class="sig-name descname"><span class="pre">PRED_TIME</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></em><a class="headerlink" href="#woods.datasets.TMNIST.PRED_TIME" title="Permalink to this definition"></a></dt>
<dd><p>The time steps where predictions are made</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TMNIST.INPUT_SHAPE">
<span class="sig-name descname"><span class="pre">INPUT_SHAPE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[28,</span> <span class="pre">28]</span></em><a class="headerlink" href="#woods.datasets.TMNIST.INPUT_SHAPE" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the input (excluding batch size and time dimension)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TMNIST.OUTPUT_SIZE">
<span class="sig-name descname"><span class="pre">OUTPUT_SIZE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">2</span></em><a class="headerlink" href="#woods.datasets.TMNIST.OUTPUT_SIZE" title="Permalink to this definition"></a></dt>
<dd><p>The size of the output</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TMNIST.ENVS">
<span class="sig-name descname"><span class="pre">ENVS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">['grey']</span></em><a class="headerlink" href="#woods.datasets.TMNIST.ENVS" title="Permalink to this definition"></a></dt>
<dd><p>The environments of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.TMNIST.plot_samples">
<span class="sig-name descname"><span class="pre">plot_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TMNIST_labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.TMNIST.plot_samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">TCMNIST</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.TCMNIST" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.Multi_Domain_Dataset" title="woods.datasets.Multi_Domain_Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.Multi_Domain_Dataset</span></code></a></p>
<p>Abstract class for Temporal Colored MNIST</p>
<p>Each sample is a sequence of 4 MNIST digits.
The task is to predict at each step if the sum of the current digit and the previous one is odd or even.
Color is added to the digits that is correlated with the label of the current step.
The formulation of which is defined in the child of this class, either sequences-wise of step-wise</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>flags</strong> (<em>argparse.Namespace</em>) – argparse of training arguments</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The MNIST dataset needs to be downloaded, this is automaticaly done if the dataset isn’t in the given data_path</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST.N_STEPS">
<span class="sig-name descname"><span class="pre">N_STEPS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">5001</span></em><a class="headerlink" href="#woods.datasets.TCMNIST.N_STEPS" title="Permalink to this definition"></a></dt>
<dd><p>The number of training steps taken for this dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST.SEQ_LEN">
<span class="sig-name descname"><span class="pre">SEQ_LEN</span></span><em class="property"> <span class="pre">=</span> <span class="pre">4</span></em><a class="headerlink" href="#woods.datasets.TCMNIST.SEQ_LEN" title="Permalink to this definition"></a></dt>
<dd><p>The sequence length of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST.PRED_TIME">
<span class="sig-name descname"><span class="pre">PRED_TIME</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></em><a class="headerlink" href="#woods.datasets.TCMNIST.PRED_TIME" title="Permalink to this definition"></a></dt>
<dd><p>The time steps where predictions are made</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST.INPUT_SHAPE">
<span class="sig-name descname"><span class="pre">INPUT_SHAPE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[2,</span> <span class="pre">28,</span> <span class="pre">28]</span></em><a class="headerlink" href="#woods.datasets.TCMNIST.INPUT_SHAPE" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the input (excluding batch size and time dimension)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST.OUTPUT_SIZE">
<span class="sig-name descname"><span class="pre">OUTPUT_SIZE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">2</span></em><a class="headerlink" href="#woods.datasets.TCMNIST.OUTPUT_SIZE" title="Permalink to this definition"></a></dt>
<dd><p>The size of the output</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST.plot_samples">
<span class="sig-name descname"><span class="pre">plot_samples</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.TCMNIST.plot_samples" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST_seq">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">TCMNIST_seq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_hparams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.TCMNIST_seq" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.TCMNIST" title="woods.datasets.TCMNIST"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.TCMNIST</span></code></a></p>
<p>Temporal Colored MNIST Sequence</p>
<p>Each sample is a sequence of 4 MNIST digits.
The task is to predict at each step if the sum of the current digit and the previous one is odd or even.
Color is added to the digits that is correlated with the label of the current step.</p>
<p>The correlation of the color to the label is constant across sequences and whole sequences are sampled from an environmnent definition</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>argparse.Namespace</em>) – argparse of training arguments</p></li>
<li><p><strong>training_hparams</strong> (<em>dict</em>) – dictionnary of training hyper parameters coming from the hyperparams.py file</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The MNIST dataset needs to be downloaded, this is automaticaly done if the dataset isn’t in the given data_path</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST_seq.SETUP">
<span class="sig-name descname"><span class="pre">SETUP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'seq'</span></em><a class="headerlink" href="#woods.datasets.TCMNIST_seq.SETUP" title="Permalink to this definition"></a></dt>
<dd><p>The setup of the dataset (‘seq’ or ‘step’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST_seq.ENVS">
<span class="sig-name descname"><span class="pre">ENVS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[0.1,</span> <span class="pre">0.8,</span> <span class="pre">0.9]</span></em><a class="headerlink" href="#woods.datasets.TCMNIST_seq.ENVS" title="Permalink to this definition"></a></dt>
<dd><p>list of different correlation values between the color and the label</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST_seq.LABEL_NOISE">
<span class="sig-name descname"><span class="pre">LABEL_NOISE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0.25</span></em><a class="headerlink" href="#woods.datasets.TCMNIST_seq.LABEL_NOISE" title="Permalink to this definition"></a></dt>
<dd><p>Level of noise added to the labels</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST_seq.color_dataset">
<span class="sig-name descname"><span class="pre">color_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.TCMNIST_seq.color_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Color the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> (<em>Tensor</em>) – 3 channel images to color</p></li>
<li><p><strong>labels</strong> (<em>Tensor</em>) – labels of the images</p></li>
<li><p><strong>p</strong> (<em>float</em>) – correlation between the color and the label</p></li>
<li><p><strong>d</strong> (<em>float</em>) – level of noise added to the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>colored images</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>colored_images (Tensor)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST_step">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">TCMNIST_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_hparams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.TCMNIST_step" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.TCMNIST" title="woods.datasets.TCMNIST"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.TCMNIST</span></code></a></p>
<p>Temporal Colored MNIST Step</p>
<p>Each sample is a sequence of 4 MNIST digits.
The task is to predict at each step if the sum of the current digit and the previous one is odd or even.
Color is added to the digits that is correlated with the label of the current step.</p>
<p>The correlation of the color to the label is varying across sequences and time steps are sampled from an environmnent definition.
By definition, the test environment is always the last time step in the sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>argparse.Namespace</em>) – argparse of training arguments</p></li>
<li><p><strong>training_hparams</strong> (<em>dict</em>) – dictionnary of training hyper parameters coming from the hyperparams.py file</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The MNIST dataset needs to be downloaded, this is automaticaly done if the dataset isn’t in the given data_path</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST_step.SETUP">
<span class="sig-name descname"><span class="pre">SETUP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'step'</span></em><a class="headerlink" href="#woods.datasets.TCMNIST_step.SETUP" title="Permalink to this definition"></a></dt>
<dd><p>The setup of the dataset (‘seq’ or ‘step’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST_step.ENVS">
<span class="sig-name descname"><span class="pre">ENVS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[0.9,</span> <span class="pre">0.8,</span> <span class="pre">0.1]</span></em><a class="headerlink" href="#woods.datasets.TCMNIST_step.ENVS" title="Permalink to this definition"></a></dt>
<dd><p>list of different correlation values between the color and the label</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST_step.LABEL_NOISE">
<span class="sig-name descname"><span class="pre">LABEL_NOISE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">0.25</span></em><a class="headerlink" href="#woods.datasets.TCMNIST_step.LABEL_NOISE" title="Permalink to this definition"></a></dt>
<dd><p>Level of noise added to the labels</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST_step.color_dataset">
<span class="sig-name descname"><span class="pre">color_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.TCMNIST_step.color_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Color a single step ‘env_id’ of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> (<em>Tensor</em>) – 3 channel images to color</p></li>
<li><p><strong>labels</strong> (<em>Tensor</em>) – labels of the images</p></li>
<li><p><strong>env_id</strong> (<em>int</em>) – environment id</p></li>
<li><p><strong>p</strong> (<em>float</em>) – correlation between the color and the label</p></li>
<li><p><strong>d</strong> (<em>float</em>) – level of noise added to the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>all dataset with a new step colored</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>colored_images (Tensor)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.TCMNIST_step.split_data">
<span class="sig-name descname"><span class="pre">split_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.TCMNIST_step.split_data" title="Permalink to this definition"></a></dt>
<dd><p>Group data and prediction by environment</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>Tensor</em>) – output data from a model (batch_size, len(PRED_TIME), n_classes)</p></li>
<li><p><strong>labels</strong> (<em>Tensor</em>) – labels of the data (batch_size, len(PRED_TIME))</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The reshaped data (n_env-1, batch_size, 1, n_classes)
Tensor: The reshaped labels (n_env-1, batch_size, 1)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.EEG_dataset">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">EEG_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">h5_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.EEG_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.dataset.T_co</span></code>]</p>
<p>HDF5 dataset for EEG data</p>
<p>The HDF5 file is expected to have the following nested dict structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;env0&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">,</span> <span class="n">input_size</span><span class="p">),</span>
          <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">PRED_TIME</span><span class="p">))},</span>
<span class="s1">&#39;env1&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;data&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">time_steps</span><span class="p">,</span> <span class="n">input_size</span><span class="p">),</span>
         <span class="s1">&#39;labels&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">PRED_TIME</span><span class="p">))},</span>
<span class="o">...</span><span class="p">}</span>
</pre></div>
</div>
<p>Good thing about this is that it imports data only when it needs to and thus saves ram space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5_path</strong> (<em>str</em>) – absolute path to the hdf5 file</p></li>
<li><p><strong>env_id</strong> (<em>int</em>) – environment id key in the hdf5 file</p></li>
<li><p><strong>split</strong> (<em>list</em>) – list of indices of the dataset the belong to the split. If ‘None’, all the data is used</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.EEG_dataset.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.EEG_dataset.close" title="Permalink to this definition"></a></dt>
<dd><p>Close the hdf5 file link</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.Sleep_DB">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">Sleep_DB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_hparams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.Sleep_DB" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.Multi_Domain_Dataset" title="woods.datasets.Multi_Domain_Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.Multi_Domain_Dataset</span></code></a></p>
<p>Class for Sleep Staging datasets with their data stored in a HDF5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>argparse.Namespace</em>) – argparse of training arguments</p></li>
<li><p><strong>training_hparams</strong> (<em>dict</em>) – dictionnary of training hyper parameters coming from the hyperparams.py file</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Sleep_DB.CHECKPOINT_FREQ">
<span class="sig-name descname"><span class="pre">CHECKPOINT_FREQ</span></span><em class="property"> <span class="pre">=</span> <span class="pre">500</span></em><a class="headerlink" href="#woods.datasets.Sleep_DB.CHECKPOINT_FREQ" title="Permalink to this definition"></a></dt>
<dd><p>The frequency of results update</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Sleep_DB.SETUP">
<span class="sig-name descname"><span class="pre">SETUP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'seq'</span></em><a class="headerlink" href="#woods.datasets.Sleep_DB.SETUP" title="Permalink to this definition"></a></dt>
<dd><p>The setup of the dataset (‘seq’ or ‘step’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Sleep_DB.SEQ_LEN">
<span class="sig-name descname"><span class="pre">SEQ_LEN</span></span><em class="property"> <span class="pre">=</span> <span class="pre">3000</span></em><a class="headerlink" href="#woods.datasets.Sleep_DB.SEQ_LEN" title="Permalink to this definition"></a></dt>
<dd><p>The sequence length of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Sleep_DB.PRED_TIME">
<span class="sig-name descname"><span class="pre">PRED_TIME</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[2999]</span></em><a class="headerlink" href="#woods.datasets.Sleep_DB.PRED_TIME" title="Permalink to this definition"></a></dt>
<dd><p>The time steps where predictions are made</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Sleep_DB.OUTPUT_SIZE">
<span class="sig-name descname"><span class="pre">OUTPUT_SIZE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">6</span></em><a class="headerlink" href="#woods.datasets.Sleep_DB.OUTPUT_SIZE" title="Permalink to this definition"></a></dt>
<dd><p>The size of the output</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.Sleep_DB.DATA_FILE">
<span class="sig-name descname"><span class="pre">DATA_FILE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#woods.datasets.Sleep_DB.DATA_FILE" title="Permalink to this definition"></a></dt>
<dd><p>realative path to the hdf5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.Sleep_DB.get_class_weight">
<span class="sig-name descname"><span class="pre">get_class_weight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.Sleep_DB.get_class_weight" title="Permalink to this definition"></a></dt>
<dd><p>Compute class weight for class balanced training</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of weights of length OUTPUT_SIZE</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.CAP">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">CAP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_hparams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.CAP" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.Sleep_DB" title="woods.datasets.Sleep_DB"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.Sleep_DB</span></code></a></p>
<p>CAP Sleep stage dataset</p>
<p>The task is to classify the sleep stage from EEG and other modalities of signals.
This dataset only uses about half of the raw dataset because of the incompatibility of some measurements.
We use the 5 most commonly used machines in the database to create the 5 seperate environment to train on.
The machines that were used were infered by grouping together the recording that had the same channels, and the
final preprocessed data only include the channels that were in common between those 5 machines.</p>
<dl class="simple">
<dt>You can read more on the data itself and it’s provenance on Physionet.org:</dt><dd><p><a class="reference external" href="https://physionet.org/content/capslpdb/1.0.0/">https://physionet.org/content/capslpdb/1.0.0/</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>argparse.Namespace</em>) – argparse of training arguments</p></li>
<li><p><strong>training_hparams</strong> (<em>dict</em>) – dictionnary of training hyper parameters coming from the hyperparams.py file</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This dataset need to be downloaded and preprocessed. This can be done with the download.py script.</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.CAP.DATA_FILE">
<span class="sig-name descname"><span class="pre">DATA_FILE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'physionet.org/CAP.h5'</span></em><a class="headerlink" href="#woods.datasets.CAP.DATA_FILE" title="Permalink to this definition"></a></dt>
<dd><p>realative path to the hdf5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.CAP.ENVS">
<span class="sig-name descname"><span class="pre">ENVS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">['Machine0',</span> <span class="pre">'Machine1',</span> <span class="pre">'Machine2',</span> <span class="pre">'Machine3',</span> <span class="pre">'Machine4']</span></em><a class="headerlink" href="#woods.datasets.CAP.ENVS" title="Permalink to this definition"></a></dt>
<dd><p>The environments of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.CAP.INPUT_SHAPE">
<span class="sig-name descname"><span class="pre">INPUT_SHAPE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[19]</span></em><a class="headerlink" href="#woods.datasets.CAP.INPUT_SHAPE" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the input (excluding batch size and time dimension)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.SEDFx">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">SEDFx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_hparams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.SEDFx" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.Sleep_DB" title="woods.datasets.Sleep_DB"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.Sleep_DB</span></code></a></p>
<p>SEDFx Sleep stage dataset</p>
<p>The task is to classify the sleep stage from EEG and other modalities of signals.
This dataset only uses about half of the raw dataset because of the incompatibility of some measurements.
We split the dataset in 5 environments to train on, each of them containing the data taken from a given group age.</p>
<dl class="simple">
<dt>You can read more on the data itself and it’s provenance on Physionet.org:</dt><dd><p><a class="reference external" href="https://physionet.org/content/sleep-edfx/1.0.0/">https://physionet.org/content/sleep-edfx/1.0.0/</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>argparse.Namespace</em>) – argparse of training arguments</p></li>
<li><p><strong>training_hparams</strong> (<em>dict</em>) – dictionnary of training hyper parameters coming from the hyperparams.py file</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This dataset need to be downloaded and preprocessed. This can be done with the download.py script</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.SEDFx.DATA_FILE">
<span class="sig-name descname"><span class="pre">DATA_FILE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'physionet.org/SEDFx.h5'</span></em><a class="headerlink" href="#woods.datasets.SEDFx.DATA_FILE" title="Permalink to this definition"></a></dt>
<dd><p>realative path to the hdf5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.SEDFx.ENVS">
<span class="sig-name descname"><span class="pre">ENVS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">['Age</span> <span class="pre">20-40',</span> <span class="pre">'Age</span> <span class="pre">40-60',</span> <span class="pre">'Age</span> <span class="pre">60-80',</span> <span class="pre">'Age</span> <span class="pre">80-100']</span></em><a class="headerlink" href="#woods.datasets.SEDFx.ENVS" title="Permalink to this definition"></a></dt>
<dd><p>The environments of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.SEDFx.INPUT_SHAPE">
<span class="sig-name descname"><span class="pre">INPUT_SHAPE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[4]</span></em><a class="headerlink" href="#woods.datasets.SEDFx.INPUT_SHAPE" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the input (excluding batch size and time dimension)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.MI">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">MI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_hparams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.MI" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.Sleep_DB" title="woods.datasets.Sleep_DB"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.Sleep_DB</span></code></a></p>
<p>MI datasets</p>
<p>The task is to classify the motor imaginary from EEG and other modalities of signals.
The raw data comes from the three MI Databases:</p>
<blockquote>
<div><p>[‘Cho2017’, ‘PhysionetMI’, ‘BNCI2014001’]</p>
</div></blockquote>
<dl class="simple">
<dt>You can read more on the data itself and it’s provenance on:</dt><dd><p><a class="reference external" href="http://moabb.neurotechx.com/docs/api.html#motor-imagery-datasets">http://moabb.neurotechx.com/docs/api.html#motor-imagery-datasets</a></p>
</dd>
</dl>
<p>This dataset need to be downloaded and preprocessed. This can be done with the download.py script</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.MI.DATA_FILE">
<span class="sig-name descname"><span class="pre">DATA_FILE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'MI.h5'</span></em><a class="headerlink" href="#woods.datasets.MI.DATA_FILE" title="Permalink to this definition"></a></dt>
<dd><p>realative path to the hdf5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.MI.ENVS">
<span class="sig-name descname"><span class="pre">ENVS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">['Cho2017',</span> <span class="pre">'PhysionetMI',</span> <span class="pre">'BNCI2014001']</span></em><a class="headerlink" href="#woods.datasets.MI.ENVS" title="Permalink to this definition"></a></dt>
<dd><p>The environments of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.MI.SEQ_LEN">
<span class="sig-name descname"><span class="pre">SEQ_LEN</span></span><em class="property"> <span class="pre">=</span> <span class="pre">750</span></em><a class="headerlink" href="#woods.datasets.MI.SEQ_LEN" title="Permalink to this definition"></a></dt>
<dd><p>The sequence length of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.MI.PRED_TIME">
<span class="sig-name descname"><span class="pre">PRED_TIME</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[749]</span></em><a class="headerlink" href="#woods.datasets.MI.PRED_TIME" title="Permalink to this definition"></a></dt>
<dd><p>The time steps where predictions are made</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.MI.INPUT_SHAPE">
<span class="sig-name descname"><span class="pre">INPUT_SHAPE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[22]</span></em><a class="headerlink" href="#woods.datasets.MI.INPUT_SHAPE" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the input (excluding batch size and time dimension)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.MI.OUTPUT_SIZE">
<span class="sig-name descname"><span class="pre">OUTPUT_SIZE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">2</span></em><a class="headerlink" href="#woods.datasets.MI.OUTPUT_SIZE" title="Permalink to this definition"></a></dt>
<dd><p>The size of the output</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.StockVolatility">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">StockVolatility</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_hparams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.StockVolatility" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.Multi_Domain_Dataset" title="woods.datasets.Multi_Domain_Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.Multi_Domain_Dataset</span></code></a></p>
<p>Stock Volatility Dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>argparse.Namespace</em>) – argparse of training arguments</p></li>
<li><p><strong>training_hparams</strong> (<em>dict</em>) – dictionnary of training hyper parameters coming from the hyperparams.py file</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Ressources:</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://github.com/lukaszbanasiak/yahoo-finance">https://github.com/lukaszbanasiak/yahoo-finance</a></p></li>
<li><p><a class="reference external" href="https://medium.com/analytics-vidhya/predicting-the-volatility-of-stock-data-56f8938ab99d">https://medium.com/analytics-vidhya/predicting-the-volatility-of-stock-data-56f8938ab99d</a></p></li>
<li><p><a class="reference external" href="https://medium.com/analytics-vidhya/univariate-forecasting-for-the-volatility-of-the-stock-data-using-deep-learning-6c8a4df7edf9">https://medium.com/analytics-vidhya/univariate-forecasting-for-the-volatility-of-the-stock-data-using-deep-learning-6c8a4df7edf9</a></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.StockVolatility.N_STEPS">
<span class="sig-name descname"><span class="pre">N_STEPS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">5001</span></em><a class="headerlink" href="#woods.datasets.StockVolatility.N_STEPS" title="Permalink to this definition"></a></dt>
<dd><p>The number of training steps taken for this dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.StockVolatility.SETUP">
<span class="sig-name descname"><span class="pre">SETUP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'step'</span></em><a class="headerlink" href="#woods.datasets.StockVolatility.SETUP" title="Permalink to this definition"></a></dt>
<dd><p>The setup of the dataset (‘seq’ or ‘step’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.StockVolatility.PRED_TIME">
<span class="sig-name descname"><span class="pre">PRED_TIME</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[3000]</span></em><a class="headerlink" href="#woods.datasets.StockVolatility.PRED_TIME" title="Permalink to this definition"></a></dt>
<dd><p>The time steps where predictions are made</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.StockVolatility.ENVS">
<span class="sig-name descname"><span class="pre">ENVS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">['2000-2004',</span> <span class="pre">'2005-2009',</span> <span class="pre">'2010-2014',</span> <span class="pre">'2015-2020']</span></em><a class="headerlink" href="#woods.datasets.StockVolatility.ENVS" title="Permalink to this definition"></a></dt>
<dd><p>The environments of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.StockVolatility.INPUT_SHAPE">
<span class="sig-name descname"><span class="pre">INPUT_SHAPE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[1000000]</span></em><a class="headerlink" href="#woods.datasets.StockVolatility.INPUT_SHAPE" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the input (excluding batch size and time dimension)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.StockVolatility.OUTPUT_SIZE">
<span class="sig-name descname"><span class="pre">OUTPUT_SIZE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">1</span></em><a class="headerlink" href="#woods.datasets.StockVolatility.OUTPUT_SIZE" title="Permalink to this definition"></a></dt>
<dd><p>The size of the output</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.StockVolatility.CHECKPOINT_FREQ">
<span class="sig-name descname"><span class="pre">CHECKPOINT_FREQ</span></span><em class="property"> <span class="pre">=</span> <span class="pre">500</span></em><a class="headerlink" href="#woods.datasets.StockVolatility.CHECKPOINT_FREQ" title="Permalink to this definition"></a></dt>
<dd><p>The frequency of results update</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.Video_dataset">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">Video_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transform</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.Video_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.data.dataset.T_co</span></code>]</p>
<p>Video dataset</p>
<p>Folder structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>data_path
    └── 001
        └─ 001
            ├── frame000001.jpg
            ├── ...
            └── frame0000{n_frames}.jpg
        └─ 002
        └─ (samples) ...
    └── 002
        └─ 001
        └─ 002
        └─ (samples) ...
    └── 003
    └── (labels) ...
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_path</strong> (<em>str</em>) – path to the folder containing the data</p></li>
<li><p><strong>n_frames</strong> (<em>int</em>) – number of frames in each video</p></li>
<li><p><strong>transform</strong> (<em>callable</em><em>, </em><em>optional</em>) – Optional transform to be applied
on a sample.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.Video_dataset.read_images">
<span class="sig-name descname"><span class="pre">read_images</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selected_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_transform</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.Video_dataset.read_images" title="Permalink to this definition"></a></dt>
<dd><p>Read images from a folder (single video consisting of n_frames images)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>selected_folder</strong> (<em>str</em>) – path to the folder containing the images</p></li>
<li><p><strong>use_transform</strong> (<em>callable</em>) – transform to apply on the images</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>images tensor (n_frames, 3, 224, 224)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.LSA64">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">LSA64</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_hparams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.LSA64" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.Multi_Domain_Dataset" title="woods.datasets.Multi_Domain_Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.Multi_Domain_Dataset</span></code></a></p>
<p>LSA64: A Dataset for Argentinian Sign Language dataset</p>
<p>This dataset is composed of videos of different signers.</p>
<p>You can read more on the data itself and it’s provenance from it’s source:</p>
<blockquote>
<div><p><a class="reference external" href="http://facundoq.github.io/datasets/lsa64/">http://facundoq.github.io/datasets/lsa64/</a></p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>argparse.Namespace</em>) – argparse of training arguments</p></li>
<li><p><strong>training_hparams</strong> (<em>dict</em>) – dictionnary of training hyper parameters coming from the hyperparams.py file</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This dataset need to be downloaded and preprocessed. This can be done with the download.py script</p>
</div>
<dl class="simple">
<dt>Ressources:</dt><dd><ul class="simple">
<li><p><a class="reference external" href="http://facundoq.github.io/datasets/lsa64/">http://facundoq.github.io/datasets/lsa64/</a></p></li>
<li><p><a class="reference external" href="http://facundoq.github.io/guides/sign_language_datasets/slr">http://facundoq.github.io/guides/sign_language_datasets/slr</a></p></li>
<li><p><a class="reference external" href="https://sci-hub.mksa.top/10.1007/978-981-10-7566-7_63">https://sci-hub.mksa.top/10.1007/978-981-10-7566-7_63</a></p></li>
<li><p><a class="reference external" href="https://github.com/hthuwal/sign-language-gesture-recognition/">https://github.com/hthuwal/sign-language-gesture-recognition/</a></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.LSA64.N_STEPS">
<span class="sig-name descname"><span class="pre">N_STEPS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">5001</span></em><a class="headerlink" href="#woods.datasets.LSA64.N_STEPS" title="Permalink to this definition"></a></dt>
<dd><p>The number of training steps taken for this dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.LSA64.SETUP">
<span class="sig-name descname"><span class="pre">SETUP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'seq'</span></em><a class="headerlink" href="#woods.datasets.LSA64.SETUP" title="Permalink to this definition"></a></dt>
<dd><p>The setup of the dataset (‘seq’ or ‘step’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.LSA64.PRED_TIME">
<span class="sig-name descname"><span class="pre">PRED_TIME</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[19]</span></em><a class="headerlink" href="#woods.datasets.LSA64.PRED_TIME" title="Permalink to this definition"></a></dt>
<dd><p>The time steps where predictions are made</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.LSA64.ENVS">
<span class="sig-name descname"><span class="pre">ENVS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">['001',</span> <span class="pre">'002',</span> <span class="pre">'003',</span> <span class="pre">'004',</span> <span class="pre">'005',</span> <span class="pre">'006',</span> <span class="pre">'007',</span> <span class="pre">'008',</span> <span class="pre">'009',</span> <span class="pre">'010']</span></em><a class="headerlink" href="#woods.datasets.LSA64.ENVS" title="Permalink to this definition"></a></dt>
<dd><p>The environments of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.LSA64.INPUT_SHAPE">
<span class="sig-name descname"><span class="pre">INPUT_SHAPE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[3,</span> <span class="pre">224,</span> <span class="pre">224]</span></em><a class="headerlink" href="#woods.datasets.LSA64.INPUT_SHAPE" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the input (excluding batch size and time dimension)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.LSA64.OUTPUT_SIZE">
<span class="sig-name descname"><span class="pre">OUTPUT_SIZE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">64</span></em><a class="headerlink" href="#woods.datasets.LSA64.OUTPUT_SIZE" title="Permalink to this definition"></a></dt>
<dd><p>The size of the output</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.LSA64.CHECKPOINT_FREQ">
<span class="sig-name descname"><span class="pre">CHECKPOINT_FREQ</span></span><em class="property"> <span class="pre">=</span> <span class="pre">100</span></em><a class="headerlink" href="#woods.datasets.LSA64.CHECKPOINT_FREQ" title="Permalink to this definition"></a></dt>
<dd><p>The frequency of results update</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.LSA64.SEQ_LEN">
<span class="sig-name descname"><span class="pre">SEQ_LEN</span></span><em class="property"> <span class="pre">=</span> <span class="pre">20</span></em><a class="headerlink" href="#woods.datasets.LSA64.SEQ_LEN" title="Permalink to this definition"></a></dt>
<dd><p>number of frames in each video</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.LSA64.DATA_FOLDER">
<span class="sig-name descname"><span class="pre">DATA_FOLDER</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'LSA64'</span></em><a class="headerlink" href="#woods.datasets.LSA64.DATA_FOLDER" title="Permalink to this definition"></a></dt>
<dd><p>path to the folder containing the data</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="woods.datasets.LSA64.get_class_weight">
<span class="sig-name descname"><span class="pre">get_class_weight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.LSA64.get_class_weight" title="Permalink to this definition"></a></dt>
<dd><p>Compute class weight for class balanced training</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of weights of length OUTPUT_SIZE</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="woods.datasets.HAR">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">woods.datasets.</span></span><span class="sig-name descname"><span class="pre">HAR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flags</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_hparams</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#woods.datasets.HAR" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="../woods.datasets.html#woods.datasets.Multi_Domain_Dataset" title="woods.datasets.Multi_Domain_Dataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">woods.datasets.Multi_Domain_Dataset</span></code></a></p>
<p>Heterogeneity Acrivity Recognition Dataset (HAR)</p>
<p>This dataset is composed of wearables measurements during different activities.
The goal is to classify those activities (stand, sit, walk, bike, stairs up, stairs down).</p>
<dl class="simple">
<dt>You can read more on the data itself and it’s provenance from it’s source:</dt><dd><p><a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Heterogeneity+Activity+Recognition">https://archive.ics.uci.edu/ml/datasets/Heterogeneity+Activity+Recognition</a></p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flags</strong> (<em>argparse.Namespace</em>) – argparse of training arguments</p></li>
<li><p><strong>training_hparams</strong> (<em>dict</em>) – dictionnary of training hyper parameters coming from the hyperparams.py file</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This dataset need to be downloaded and preprocessed. This can be done with the download.py script</p>
</div>
<dl class="simple">
<dt>Ressources:</dt><dd><ul class="simple">
<li><p><a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/Heterogeneity+Activity+Recognition">https://archive.ics.uci.edu/ml/datasets/Heterogeneity+Activity+Recognition</a></p></li>
<li><p><a class="reference external" href="https://dl.acm.org/doi/10.1145/2809695.2809718">https://dl.acm.org/doi/10.1145/2809695.2809718</a></p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.HAR.N_STEPS">
<span class="sig-name descname"><span class="pre">N_STEPS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">5001</span></em><a class="headerlink" href="#woods.datasets.HAR.N_STEPS" title="Permalink to this definition"></a></dt>
<dd><p>The number of training steps taken for this dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.HAR.SETUP">
<span class="sig-name descname"><span class="pre">SETUP</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'seq'</span></em><a class="headerlink" href="#woods.datasets.HAR.SETUP" title="Permalink to this definition"></a></dt>
<dd><p>The setup of the dataset (‘seq’ or ‘step’)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.HAR.SEQ_LEN">
<span class="sig-name descname"><span class="pre">SEQ_LEN</span></span><em class="property"> <span class="pre">=</span> <span class="pre">500</span></em><a class="headerlink" href="#woods.datasets.HAR.SEQ_LEN" title="Permalink to this definition"></a></dt>
<dd><p>The sequence length of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.HAR.PRED_TIME">
<span class="sig-name descname"><span class="pre">PRED_TIME</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[499]</span></em><a class="headerlink" href="#woods.datasets.HAR.PRED_TIME" title="Permalink to this definition"></a></dt>
<dd><p>The time steps where predictions are made</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.HAR.ENVS">
<span class="sig-name descname"><span class="pre">ENVS</span></span><em class="property"> <span class="pre">=</span> <span class="pre">['nexus4',</span> <span class="pre">'s3',</span> <span class="pre">'s3mini',</span> <span class="pre">'lgwatch',</span> <span class="pre">'gear']</span></em><a class="headerlink" href="#woods.datasets.HAR.ENVS" title="Permalink to this definition"></a></dt>
<dd><p>The environments of the dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.HAR.INPUT_SHAPE">
<span class="sig-name descname"><span class="pre">INPUT_SHAPE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">[6]</span></em><a class="headerlink" href="#woods.datasets.HAR.INPUT_SHAPE" title="Permalink to this definition"></a></dt>
<dd><p>The shape of the input (excluding batch size and time dimension)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.HAR.OUTPUT_SIZE">
<span class="sig-name descname"><span class="pre">OUTPUT_SIZE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">6</span></em><a class="headerlink" href="#woods.datasets.HAR.OUTPUT_SIZE" title="Permalink to this definition"></a></dt>
<dd><p>The size of the output</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.HAR.CHECKPOINT_FREQ">
<span class="sig-name descname"><span class="pre">CHECKPOINT_FREQ</span></span><em class="property"> <span class="pre">=</span> <span class="pre">100</span></em><a class="headerlink" href="#woods.datasets.HAR.CHECKPOINT_FREQ" title="Permalink to this definition"></a></dt>
<dd><p>The frequency of results update</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="woods.datasets.HAR.DATA_FILE">
<span class="sig-name descname"><span class="pre">DATA_FILE</span></span><em class="property"> <span class="pre">=</span> <span class="pre">'HAR/HAR.h5'</span></em><a class="headerlink" href="#woods.datasets.HAR.DATA_FILE" title="Permalink to this definition"></a></dt>
<dd><p>Path to the file containing the data</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Jean-Christophe Gagnon-Audet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>